{"version":3,"file":"advanced-scenarios.test.js","sourceRoot":"","sources":["../../../../test/integration/defender/advanced-scenarios.test.ts"],"names":[],"mappings":"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"}